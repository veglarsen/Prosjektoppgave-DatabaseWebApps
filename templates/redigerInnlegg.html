{% extends 'base.html' %}
{% block body %}
    <div class = "container">
            <h2>Rediger innlegg</h2>
            <form action="{{ url_for('redigerInnlegg') }}" method="post">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <div>
{#                    {{ form.tags }}#}
                </div>
                <div>
                    {{ form.tittel.label }}<br>
                    {{ form.tittel(size=32) }}<br>
                    {%  for error in form.tittel.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div>
                    {{ form.ingress.label }}<br>
                    {{ form.ingress(size=40) }}<br>
                    {% for error in form.ingress.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div>
                    {{ form.innlegg.label }}<br>
                    {{ form.innlegg(cols=30) }}<br>
                    {%  for error in form.innlegg.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div>
                    {{ form.id }}
                    {%  for error in form.id.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div>
                    {{ form.tag.label }}<br>
                    {{ form.tag(size=10) }}<br>
                    {%  for error in form.tag.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div>
                    {{ form.newTag.label }}<br>
                    {{ form.newTag(size=10) }}<br>
                    {%  for error in form.newTag.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <p>{{ form.submit() }}</p>
            </form>
            {%if attachments %}
		        <div id="filliste">
                    <ul>
                        {% for attachment in attachments %}
                            {% if attachment.fil_type == 'image/jpeg' or  attachment.fil_type == 'image/pjpeg' or attachment.fil_type == 'image/png' or attachment.fil_type == 'image/gif'%}
                                  <a href="{{url_for('download_file', id=attachment.vedlegg_ID, _external=True) }}">
                                      <img src="{{url_for('download_file', id=attachment.vedlegg_ID, _external=True)}}" width="10%"/></a>
                                <a href="{{ url_for('delete_file', id=attachment.innlegg_ID, vedleggID=attachment.vedlegg_ID, _external=True) }}">Slett</a>
                           {% elif attachment.fil_type == 'video/mp4' or attachment.fil_type == 'video/webm' or attachment.fil_type == 'video/ogg' %}
                              <video width="25%" height="100%" controls>
                                  <source src="{{url_for('download_file', id=attachment.vedlegg_ID, _external=True)}}" type="{{attachment.fil_type}}">
                              </video>
                              <a href="{{ url_for('delete_file', id=attachment.innlegg_ID, vedleggID=attachment.vedlegg_ID, _external=True) }}">Slett</a>
                            {% else %}
                               <li>
                                {{attachment.fil_navn}}&nbsp;<a href="{{url_for('download_file', id=attachment.vedlegg_ID, _external=True)}}">{{attachment.fil_navn}}</a>
                                <a href="{{ url_for('delete_file', id=attachment.innlegg_ID, vedleggID=attachment.vedlegg_ID, _external=True) }}">Slett</a>
                               </li>
                           {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
            <h3>Upload new File</h3>
                <form action="{{ url_for('upload_file', id=form.id.data, _external=True) }}" method=post enctype=multipart/form-data>
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="MAX_FILE_SIZE" value="2097152" />
                    <p><input type=file name=file></p>
                    <input type=submit value=Upload>
                </form>
            <a href="{{ url_for('forside') }}">Avbryt</a>
    </div>
{% endblock %}